Пользователи
============

Шаблон реализует две модели авторизации пользователя:

- Единый ключ авторизации (только на одном устройстве)
- Множественная авторизация (на любом количестве устройств одновременно)

Основной функционал по работе с ключами скрыт в самой моделе пользователя
и адаптирован для идентификации пользователя в `yii\web\User` с поддержкой
автоматической авторизации по токену авторизации. Но в силу разного подхода
к ведению ключей авторизации, метод генерации токена авторизации расширен,
относительно базовой реализации.

Выбор способа ведения пользователей определяется на момент создания приложения
и по возможности лишний код убирается из репозитория, если не используются оба
варианта в разных приложениях.

IdentityRecord
--------------

Классическая модель с единым ключем авторизации. Является базовым методов
авторизации в шаблоне. Для ее работы достаточно добавить в миграцию добавления
пользоватлея поле `auth_key` (строка 32 символа, не обязательное поле).
По умолчанию данное поле уже имеется в миграции инициализации.

IdentityTokensRecord
--------------------

Расширенная модель авторизации с использованием дополнительной таблицы с ключами
авторизации для каждого устройства. Модель исключает использование внутреннего
токена авторизации в самой таблице пользователя, поэтому поле из миграции
инициализации. Но в силу необходимости внешней таблицы, необходимо выполнить
миграцию для таблицы ключей авторизации, которая лежит в папке с модулем:

```bash
./yii migrate/up --migrationPath='@common/modules/user/migrations'
```

Дополнительным условием использования данной модели является тот факт, что
токен удаляется в момент истечения его срока годности. Поэтому при авторизации,
если пользователей не хочет, чтобы его запоминанли, следует выставить какое-то
минимальное время его годности, например 30 минут. И чтобы пользователь неожиданно
не сбросил авторизацию, продлевать токен с каким-то промежутком времени,
например каждую минуту.
